---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { ModeToggle } from "@/components/ModeToggle";
import Logo from "@/components/Logo.astro";
import StatusIndicator from "@/components/ui/status-indicator";
import About from "@/components/About.astro";
import Landing from "@/components/Landing.astro";

interface Route {
  title: string;
  data_section: string;
  href: string;
}

const routes: Route[] = [
  { title: "Home", data_section: "landing", href: "#landing" },
  { title: "About Us", data_section: "about", href: "#about" },
  { title: "Advantage", data_section: "advantage", href: "#advantage" },
];
---

<BaseLayout
  title="ODIA Medical"
  description="Strategic Medical Staffing & Clinical Workforce Solutions"
>
  <div class="flex">
    <!-- Sidebar -->
    <aside class="flex flex-col w-52 px-10 py-10 h-screen fixed top-0 left-0">
      <div class="w-20 h-20 border border-accent p-2 bg-slate-600/10">
        <Logo />
      </div>
      <nav class="flex-1 flex flex-col justify-center gap-1">
        {
          routes.map((route) => {
            return (
              <a
                data-section={route.data_section}
                href={route.href}
                class="nav-section hover:text-primary transition-colors py-2 border-l-2 hover:border-accent-foreground pl-3 -ml-3 text-muted-foreground border-transparent"
              >
                {route.title}
              </a>
            );
          })
        }
      </nav>
      <button
        class="flex border border-accent bg-slate-600/10 py-6 px-4 items-center justify-center"
      >
        <StatusIndicator state="active" label="Contact Us" />
      </button>
    </aside>

    <!-- main content -->
    <main
      class="flex flex-col flex-1 justify-center items-center pl-52 pr-20 bg-linear-0 to-slate-300 dark:to-slate-950/70 from-neutral-300/70 dark:from-neutral-900/70 from-0% to-70%"
    >
      <!-- landing -->
      <Landing />

      <!-- about us -->
      <About />

      <!-- why trust us -->
      <section id="advantage" class="flex p-10 px-20 h-screen">
        <div>
          <h3>Rigorous Vetting</h3><p>
            Physician-led screening for all clinical staff.
          </p>
        </div>
        <div>
          <h3>Rapid Deployment</h3><p>
            Precision matching for urgent institutional needs.
          </p>
        </div>
        <div>
          <h3>Infectious Disease Expertise</h3><p>
            Specialized oversight for complex clinical environments.
          </p>
        </div>
      </section>

      <section id="industries" class="p-10">
        <h2>Sectors We Support</h2>
        <div class="flex gap-10">
          <span>Government</span>
          <span>Hospital Systems</span>
          <span>Corporate Wellness</span>
        </div>
      </section>

      <!-- team -->
      <section id="team" class="p-10">
        <h1>Our Team</h1>
      </section>

      <!-- blog -->
      <section id="blog" class="p-10">
        <h1>Blog</h1>
      </section>

      <!-- footer -->
      <section id="team" class="p-10">
        <h1>Our Team</h1>
      </section>
    </main>

    <!-- Right Sidebar -->
    <aside
      class="flex flex-col gap-4 w-20 px-8 py-10 justify-center items-center h-screen fixed right-0 top-0"
    >
      <div class="w-9 h-9 border"></div>
      <div class="w-9 h-9 border"></div>
      <div class="w-9 h-9 border"></div>
      <div class="w-9 h-9 border"></div>
      <ModeToggle client:load />
    </aside>
  </div>
  <script>
    const sections = document.querySelectorAll("section[id]");
    const navLinks = document.querySelectorAll(".nav-section");

    const observerOptions = {
      root: null,
      rootMargin: "-20% 0px -70% 0px",
      threshold: 0,
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          const sectionId = entry.target.id;

          navLinks.forEach((link) => {
            const linkSection = link.getAttribute("data-section");
            if (linkSection === sectionId) {
              link.classList.add("text-primary", "border-accent-foreground");
              link.classList.remove(
                "text-muted-foreground",
                "border-transparent",
              );
            } else {
              link.classList.remove("text-primary", "border-accent-foreground");
              link.classList.add("text-muted-foreground", "border-transparent");
            }
          });
        }
      });
    }, observerOptions);

    sections.forEach((section) => observer.observe(section));
  </script>
</BaseLayout>
